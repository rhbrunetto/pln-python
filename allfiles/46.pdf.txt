IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 32, NO. 3, MAY 2017

1839

Purchase Bidding Strategy for a Retailer With

Flexible Demands in Day-Ahead Electricity Market

Meng Song, Student Member, IEEE, and Mikael Amelin, Member, IEEE

AbstractThe paper aims to determine the day-ahead market
bidding strategies for retailers with exible demands to maximize
the short-term prot. It proposes a short-term planning framework
to forecast the load under dynamic tariffs and construct biding
curves. Stochastic programming is applied to manage the uncer-
tainties of spot price, regulating price, consumption behaviors, and
responsiveness to dynamic tariffs. A case study based on data from
Sweden is carried out. It demonstrates that a real-time selling price
can affect the aggregate load of a residential consumer group and
lead to load shift toward low-price periods. The optimal bidding
curves for specic trading periods are illustrated. Through com-
paring the bidding strategies under different risk factors, the case
study shows that a risk-averse retailer tends to adopt the strate-
gies with larger imbalances. The benet lies in the reduction of
low-prot risk. However, the aversion to risk can only be kept in a
certain level. A larger imbalance may lead to a quick reduction of
prot in all scenarios.

Index TermsBidding curve, day-ahead market, demand

response, nancial risk, imbalance settlement, retailer.

NOMENCLATURE

A. Indices


z
h
i
iW /D /S/V Load

Scenarios.
Time slots in the load model.
Households.
Load cycles.
cycles

of washing machine/

dryer/

t
c

h,

W /D /S/V

h,

hP

hN


ui,h,z ,

dishwasher/ EV charging.
Trading periods.
Nodes of the bidding curve.

B. Sets

All exible load cycles of household h in
scenario .
All washing/ drying/ dish washing/ charging
cycles of household h in scenario .
Responding subgroup in scenario .
Non-responding subgroup in scenario .

C. Optimization variables
Optimal starting status of
household h at time slot z in scenario .

load cycle i

in

Manuscript received November 30, 2015; revised March 9, 2016, May 11,
2016, and August 17, 2016; accepted August 30, 2016. Date of publication
September 12, 2016; date of current version April 17, 2017. This work was
supported by the Stockholm Royal Seaport, Urban Smart Grid Program. The
program was funded by Swedish Energy Agency, Fortum, Ericsson, Electrolux,
and ABB. Paper no. TPWRS-01708-2015.

The authors are with the Department of Electric Power and Energy Systems,
Royal Institute of Technology, Stockholm 11428, Sweden (e-mail: msong@
kth.se; amelin@kth.se).

Digital Object Identier 10.1109/TPWRS.2016.2608762

P F
z ,

P N
z ,
Pz ,

Eh,

Pt,
P A
t,

P R
t,

Z

T

H

z
t

d
I W /D /S/V
h,

Ji,h,

Pi,j,h,

ST R

i,h,

ST 1

i,h,

ST 2

i,h,

SPi,h,z ,

Pt,c
t, , P R
P R+

, 

Volume value of node c on the bidding curve for
trading period t.

t, Auxiliary variables to determine the imbalance of

trading period t in scenario .
Auxiliary variables for calculating CVaR.

P R

i,h,z , Reference power demand of load cycle i in household

D. Other variables

h at time slot z in scenario .
Reference aggregate exible load at time slot z in
scenario .
Aggregate inexible load at time slot z in scenario .
New aggregate load after demand response at time
slot z in scenario .
Electricity cost of household h due to exible loads
in scenario .
Power demand during trading period t in scenario .
Purchased volume on day-ahead market for trading
period t in scenario .
Imbalance to be settled for trading period t in
scenario .

E. Parameters
of

time

slots

in

the

planning

trading periods in the planning

Number
horizon.
Number of
horizon.
Number of households in the customer group.
Number of scenarios.
Length of a time slot.
Length of a trading period.
Probability of scenario .
DR participation rate in scenario .
Number of washing/ drying/ dish washing/
charging cycles of household h in scenario .
Number of time slots during the operation of load
cycle i of household h in scenario .
Power demand of load cycle i at time slot j of
household h in scenario .
Reference
time of
household h in scenario .
The beginning of preferred start time interval of
load cycle i of household h in scenario .
The end of preferred start time interval of load
cycle i in household h in scenario .
Start preference of load cycle i of household h at
time slot z in scenario .

load cycle

i of

start

0885-8950  2016 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.

See http://www.ieee.org/publications standards/publications/rights/index.html for more information.

1840

uR

i,h,z ,

P R ef
z ,

z ,

S
S
t,
A
t,
R
t,
P
t
t,c




time slot z in

Reference starting status of load cycle i of
household h at time slot z in scenario .
Reference aggregate load at
scenario .
Selling price of time slot z in scenario .
Selling price of trading period t in scenario .
Spot price of trading period t in scenario .
Regulating price of trading period t in scenario .
Imbalance penalty of trading period t.
Price value of node c on the bidding curve for
trading period t.
Condential level of CVaR.
Risk factor.

I. INTRODUCTION

I N A liberalized electricity market, retailers are active inter-

mediaries to buy electricity from wholesale markets and sell
to consumers. One of their major decision problems concerns the
optimal electricity procurement plans. In current market frame-
works where most residential and small commercial consumers
are charged at tariffs, retailers are exposed to quantity and price
risks [1] due to the stochastic nature of demand and volatility of
market price. Accurate load forecasts are important for retailers
to reduce the risks. The demand is inuenced by many factors
such as time, weather and consumer classes. Traditionally it can
be predicted with a high accuracy through statistical techniques
or articial intelligence algorithms such as regression, neural
networks, fuzzy logic and expert systems [2]. Moreover, future
market products such as forward contracts can be used to hedge
against the risks in the medium term [1].

The demand is inelastic when consumers are facing at tar-
iffs and are monthly (or less often) metered. The situation will
change along with the transformation of power markets and
the development of information and communication technolo-
gies in power systems. As shown in many demand response
pilots e.g. [3][7], consumers tend to change their consumption
time and magnitude in response to dynamic tariffs or nancial
incentives when smart metering and bidirectional communica-
tion are available. The aggregate load shift or load reduction
provides exibilities to the system and consequently brings
notable benets through the improvement of economic ef-
ciency and reliability [8]. Dynamic pricing would help retailers
to reduce the risks by sharing the price risk with consumers
who potentially pay a lower average price [9], [10]. How-
ever, this also brings them challenges regarding load forecast
and planning.

A difculty for quantifying the exibility lies in the uncer-
tainty about the responsiveness of consumers to the incentives
in demand response programs. Different approaches have been
examined for retailers with exible demands to determine the
procurement plan. Elasticity is a classic way to model the price-
based demand response driven by dynamic tariffs. It quanties
the demand sensitivity with respect to price changes as described
in [11], [12], and [13]. Two types of elasticities are usually used:
self-elasticity and cross elasticity. Self-elasticity indicates the
relative demand change in response to the price change within a
single period, while cross elasticity indicates the demand change

IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 32, NO. 3, MAY 2017

of a period in response to the price changes in other periods
[14]. Reward-based demand response on the other hand could
be modelled by stepwise price-quota curves as described in
[15] and [16]. A reward is offered to consumers if the demand
in a period is reduced by a certain level or does not exceed an
amount. Generally a higher reward requires larger exibility.
Using aforementioned methods, most studies briey estimate
the exibility at a system level e.g. applying a set of elastici-
ties on the aggregate load while the elasticities are extrapolated
from empirical studies. This provides an approximation of the
aggregate exibility but overlooks the differences between the
studied consumer group and those in empirical studies regard-
ing appliance ownership, consumption habits and consumers
involvement in demand response. A more detailed approach
would be necessary when a retailer needs to estimate the re-
sponsiveness of a specic consumer group in a certain demand
response program. Bottom-up approaches are more suitable for
this purpose by considering the source where the exibility
stems from. Such approaches generally consist of two principle
components: identifying the exible end uses and dening the
levels at which each consumer responds to the incentives.

For residential consumers, the controllable home appliances
such as dishwasher, washing machine and dryers can contribute
a exibility approximately equaling to 5%-15% of the daily load
as estimated in study [17]. Furthermore, a potential exible end
use in the residential sector is the charging of electric vehicles
(EVs) even though the current ownership is still low. A few EVs
would result in a large charging load compared with other home
appliances and consequently may deliver a notable exibility
through coordinated charging [18]. Some studies e.g. [19][23]
proposed optimal algorithms for scheduling the exible end
uses and investigated their impacts on load patterns or electricity
cost. But they have seldom been considered in detail in retailers
procurement plan.

The foreseeable increasing sensitivity to price and larger price
volatility due to higher penetration of intermittent renewable
sources in the future can level up the difculty of load fore-
cast and consequently imposes risks in short-term trading, even
though the medium-term risks could be partially transferred to
consumers through different dynamic tariff structures [9]. De-
viations between the purchased volume on day-ahead market
and the real-time consumption would be more likely to happen,
leading to higher probabilities for retailers exposed to imbalance
cost. So a well developed bidding strategy in short-term would
be an important issue when more demand response applications
emerge in the future.

The main contribution of this paper is a new bottom-up load
model to forecast the aggregate power demand of a residential
customer group who may respond to dynamic tariffs. Moreover,
this load model is applied to a stochastic planning problem for
retailers with exible demands to determine the bidding strategy
on day-ahead market. Conditional Value-at-Risk (CVaR) is used
to consider the risk. The application of the stochastic planning
is demonstrated in a case study based on data from Sweden.

In contrast to the methods used in [11][15], the bottom-
up load model allows retailers to quantify the uncertainties of
consumers behavior with respect to the reference consumption
pattern and the willingness to participate in demand response.

SONG AND AMELIN: PURCHASE BIDDING STRATEGY FOR A RETAILER WITH FLEXIBLE DEMANDS IN DAY-AHEAD ELECTRICITY MARKET

1841

It employs integer linear programming to minimize the elec-
tricity bill for individual households. Unlike the models such
as [20][22] which focus on the charging algorithm of EVs or
the scheduling of other appliances individually, the load model
uses a simplied but generalized method to treat the exibil-
ity of various controllable end uses such as washing machine,
dryer, dishwasher and charging of EVs. It could be further ex-
tended to include other controllable appliances with similar load
patterns such as cooking appliances, vacuum cleaner, etc. The
model could also be utilized by other players in power market
to simulate consumers behavior under different dynamic price
structures and forecast the capacity and duration of the exi-
bility. The bidding strategies on day-ahead market have been
investigated in studies such as [24][26]. But they only deter-
mine a constant energy bid for each trading period. Contrarily,
this study applies the method proposed by [12] to construct
piecewise bidding curves. Stochastic programming is deployed
to tackle the uncertainties of prices and consumers behaviors.
Besides the different load forecast approach, a different risk
measure is applied in the study to model the risk compared to
[12]. CVaR has been widely applied in the medium term pro-
curement plan [27]. In this study, it is integrated in the planning
model to allow the retailer to compare different bidding strate-
gies by considering the trade-off between the expected prot
and the low-prot risk in short term. The bidding curves un-
der different risk factors are generated and compared in the
case study.

The paper is organized as follows. Section II describes the
problem by explaining the market framework and the uncer-
tainties involved in the decision making process. Section III
and IV provides the detailed formulations of the load model
and planning model, respectively. Section V explains the deci-
sion framework of the retailer which combines the two models.
Section VI describes the data used in a specic case and presents
the numerical results. A brief conclusion and discussion of fu-
ture works are given in Section VII.

II. PROBLEM DESCRIPTION

The paper addresses the short-term trading plan of a retailer
in a power pool. The retailer is considered as a price-taker i.e.
its bids would not affect the market clearing prices. This as-
sumption is in accordance with the situation in many liberalized
electricity markets where the trading volume of most retailers
is too small compared with the total turn-over of the market to
inuence the price.

The trading in the market is divided into three steps according
to chronological sequence. It is based on the Nordic power mar-
ket [28] which is a typical electricity market structure in Europe.
Firstly, in day-ahead trading, players submit price-volume bids
to the pool to sell or buy electricity for each trading period on
the next day. The length of trading periods could be an hour or
shorter, varying among different markets. The pool compiles all
buying and selling bids and calculates the spot price for each
trading period. A certain volume is agreed for a player according
to the cleared spot price and the bidding curve it has submitted.
Secondly, the real-time trading happens within the trad-
ing period. Producers and consumers are expected to follow

Fig. 1. One-price system for imbalance settlement.

their agreements on the day-ahead market. A real-time balanc-
ing market exists at this stage. Up- or down-regulations are
activated by the system operator when the frequency drops or
rises outside the normal operation interval due to the deviation
between supply and demand. The regulations can be provided
by producers or consumers who have set bids on the real-time
balancing market. They increase production or reduce consump-
tion for up-regulation, whereas reduce production or increase
consumption for down-regulation. The settlement of regulating
price differs among systems. For example, marginal pricing is
applied in Nordic market i.e. a uniform up-regulation price is
paid for all activated up-regulation bids, while a uniform down-
regulation price is paid for all activated down-regulation bids.
Generally, the regulating price is higher than the spot price dur-
ing an up-regulation period, whereas lower than the spot price
during a down-regulation period.

The deviations between the actual generations/consumptions
and the trading on day-ahead and real-time balancing markets
lead to potential imbalance costs for all balance responsible
players, who are responsible to nancially achieve a balance be-
tween their own supply and demand. It is common that retailers
take over the balance responsibilities of individual consumers.
The imbalance settlement is carried out in the third step after a
trading period ends. Taking the Nordic market as an example,
consumers face a one-price settlement. As shown in Fig. 1, the
same regulating price is used to settle both positive and negative
imbalances. A retailer without generation capacity must settle
the imbalance between the purchased volume in day-ahead trad-
ing and the actual extracted energy. If its customers use more
electricity than the purchase on day-ahead market, it needs to
buy the imbalance from the system operator by paying for the
excess demand at the regulating price. Otherwise, it needs to
sell the imbalance if the customers use less [28].

The decision problem of a retailer in this paper is to con-
struct piecewise linear bidding curves to submit on day-ahead
market for maximizing the short-term prot. Even though the
demand side could be a potential resource for providing up-
or down-regulations [29], the participation in the real-time bal-
ancing market is not in the scope of this paper. Therefore only
day-ahead trading and balance settlement are considered as the
interactions between the retailer and the pool. The decision
problem associates with the uncertainties of spot price, actual
power demand and regulating price. A scenario tree is con-
structed as Fig. 2 to represent possible realizations of these
stochastic factors. The root node corresponds to the rst stage at

1842

IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 32, NO. 3, MAY 2017

Fig. 3. Example of a load cycle running for 3 time slots.

Fig. 2.

Scenario tree.

which the bidding curves for all trading periods are determined.
The branches leaving the root node represent different scenarios
of spot price, reference consumption patterns and willingness to
participate in demand response. The aggregate power demand
is accordingly estimated at the second stage. The purchase of a
trading period on day-ahead market in a scenario is determined
by the bidding curve and the spot price. Imbalance would occur
if it deviates from the actual power demand. Several regulat-
ing price scenarios are then generated based on each spot price
scenario to calculate the imbalance cost at the third stage.

III. LOAD MODEL

The load model is developed to forecast the power demand
of a residential consumer group in response to dynamic tariffs.
In this study, the exibilities of washing machine, dryer, dish-
washer and EV charging are considered. The model consists of
three steps. Firstly, given the usage of these end uses in ref-
erence condition, the aggregate exible load in each time step
is quantied. The reference condition is dened as the situa-
tion when the group is charged at tariffs. Then, it estimates
how the exible loads would be shifted under dynamic tariffs
through optimization. This is based on an assumption that some
consumers tend to change the schedules of the controllable end
uses to reduce their electricity bills and satisfy their demands of
electricity simultaneously. At the end, the new aggregate load is
generated as the output based on the reference load and the new
schedules. Following is the detailed formulation of the model.

A. Step 1: Identify and Quantify the Flexible Loads in
Reference Condition
The planning horizon is divided into Z time slots that are
indexed by z  {1, ..., Z}. z is the length of one time slot.
The exible load lies in controllable home appliances in-
cluding washing machine, dryer and dishwasher as well as
charging of EVs. For household h  {1, ..., H} in scenario
  {1, ..., }, load cycle i  h, stands for one of the times
that the appliances are used or an EV is charged during the
planning horizon. The load cycles could be further indexed by
iW  W
h, , representing

h, or iV  V

h, , iD  D

h, , iS  S

the type of load: washing, drying, dish washing or EV charging.
The relationships between these sets are:
h,  V

h,  D
W
|x
h,| = I x

h,  S
h, = h,
h, ,h, , x = W, D, S, V

(1)

For simplication, load cycle i is assumed consecutively last-
ing for Ji,h, time slots which are indexed by j. The power
demand within each slot is assumed constant and symbolized
as Pi,j,h, . Actually the operation of a load cycle could be in-
terruptible. Delay function may exist in appliances, while EVs
could be intermittently charged. However, they are not the focus
of the study and are neglected hence.

When the start time of a load cycle in the reference condition
i,h, is known, the starting status uR
i,h,z , could be deter-
i,h,z , is binary: 1 indicates the cycle starting

ST R
mined from (2). uR
from time slot z, 0 otherwise.

i,h,z , =
uR

1, z = ST R
0, else

i,h,

i, h, z, 

(2)

(cid:2)

In time slot z, the reference power demand of load cycle i is

determined as:

i,h,z , =
P R

J i , h , (cid:3)

j=1

Pi,j,h, uR

i,h,zj+1, ,i, z, h, 

(3)

This can be veried through the example in Fig. 3 which illus-
trates a load cycle lasting for 3 time slots. It starts from z = 3.
Thus,

(cid:2)

z =
uR

1, z = 3
0, else

(4)

Taking z = 3 for instance, according to (3), the power demand
in it is calculated as (5). The power demands of other z can be
veried in the same way.

z =3 = Pj=1uR
P R

z =3 + Pj=2uR

z =2 + Pj=3uR

z =1 = Pj=1

(5)

In the reference condition when households are charged at
z , is the sum

tariffs, the aggregate exible load of the group P F
of power demands of all load cycles:

H(cid:3)

h=1

(cid:3)
i h, 

J i , h , (cid:3)

j=1

z , =
P F

Pi,j,h, uR

i,h,zj+1, ,z, 

(6)

SONG AND AMELIN: PURCHASE BIDDING STRATEGY FOR A RETAILER WITH FLEXIBLE DEMANDS IN DAY-AHEAD ELECTRICITY MARKET

1843

B. Step 2: Determine the Optimal Schedules of the
Controllable End Uses

In price-based demand response, consumers tend to resched-
ule the controllable home appliances and EV charging in re-
sponse to the dynamic tariffs for minimizing the electricity cost.
The optimal schedules can be achieved in two ways in prac-
tice. It could either be computed and automatically set by an
energy management system with an embedded scheduling pro-
gram e.g. [30] and [31] or intuitively decided by consumers and
set manually.

The capability and willingness to respond can vary among
consumers due to different sensitivities to the economic incen-
tives and different life styles. Assuming a percentage d of the
group would like to respond in a certain scenario, the customers
are divided into two subgroups: the responding group hP
 and
non-responding group hN
 . The number of households in each
subgroup is d H and (1  d )H, respectively.

For the responding group, optimal schedules are provided for
each household. Binary decision variables ui,h,z , are deter-
mined for the optimal schedule. It indicates the starting status
of a load cycle. The electricity cost of a household due to the
exible load during the planning horizon, Eh, , is computed by
summing up the costs of all load cycles:

Eh, =

Z(cid:3)

z =1

(cid:3)
i h, 

J i , h, (cid:3)

j=1

z , Pi,j,h, ui,h,zj+1, z,h, 
S

(7)
where S
z , refers to the tariff in time slot z. The power demand
of each load cycle in a time slot is expressed in a similar way as
(3) in the reference condition.

Several constraints are set for the operation of load cycles.
Firstly, it is necessary to guarantee that each load cycle is started
once during the planning horizon as in (8). This constraint en-
sures that consumers demands for washing, drying, dish wash-
ing or EV charging are still satised even though the schedules
would be altered.

Z(cid:3)

z =1

ui,h,z , = 1,i, h, 

(8)

Secondly, the household is assumed to own one equipment for
each type of load. Thus, different load cycles of a same equip-
ment should not overlap. The interval between the beginnings
of two cycles should allow the rst one to nish its operation
at least. The non-simultaneous operation of load cycles for the
same end use is managed by constraint (9):

uix,h,z , +

uy ,h,k ,  1

a(cid:3)

(cid:3)
h,  \ix
y x

k=z

(9)

a = z + Jix,h,  1,z, h, , ix , x = W, D, S, V,

sequential constraint can be written as:

uiw,h,z , +

z +J i w, h ,  1(cid:3)

k=z

uid,h,k ,  1,z, h, 

(10)

Thirdly, the level that a household would like to change the
reference schedules is modeled through a time preference con-
straint. It is highly dependent on the need of intervention. For
example, if it is necessary for consumers to turn on the washing
machine manually, they probably would not like to innitely
delay the washing cycle even though the electricity price could
be much lower after a long delay. Surveys show that most con-
sumers would prefer to delay the appliances up to three hours
[32]. On the other hand, higher exibility could be possible if
auto-delay functions are available. Similarly, the exibility of
EV charging is also dependent on the degree of automation. An
upper limit of the delayed starting time should be considered if
the charging is manually controlled. Otherwise, if the charging
socket could be turned on/off automatically, a default allowed
charging time can be set between the connected time and the
next leaving time.

i,h, , ST 2

The preferred start time of load cycle i is dened as a time
i,h, ]. It implies that the cycle is allowed to
interval [ST 1
start within the interval. The binary parameter, start preference
SPi,h,z , , is determined according to (11). It denotes whether
the load cycle is allowed to start or not in time slot z. The time
preference constraint is written as (12).

(cid:2)

1, z  [ST 1
0, else

SPi,h,z , =
ui,h,z ,  SPi,h,z , ,i, h, z, 

i,h, , ST 2

i,h, ]

i, h, z,  (11)

(12)

For household h  hP
 ,

summarized as:

the

scheduling problem is

Min cost function (7)

s.t. constraints (8), (9) and (12)
ui,h,z ,  {0, 1},i, h, z, 

(13)

C. Step 3: Generate New Aggregate Load Prole Using the
Optimal Schedules

Assuming the reference aggregate load P R ef
z ,

could be ob-
tained based on historical measurements through statistical
techniques such as regression, the inexible load P N
z , can be
computed by subtracting the exible loads from the total load:

z , = P R ef
P N

z ,  P F

z , ,z, 

(14)

This constraint can also handle the sequential operation be-
tween appliances such as that between a washing cycle and a
drying cycle, denoted as iw and id as example. If the drying
cycle should not start before the washing cycle has nished, the

The new aggregate load after demand response Pz , is calcu-
lated by summing up the non-exible load, the rescheduled ex-
ible loads of responding households and the reference exible

1844

IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 32, NO. 3, MAY 2017

Therefore an imbalance P R
between them as formulated in (18).

t, may happen due to the deviation

t, = P A
P R

t,  Pt, ,t, 

(18)

t, . If P R
The imbalance will be settled at the regulating price R
t,
is negative, the retailer needs to pay a cost to buy the excess
volume. Otherwise, the retailer earns by selling the imbalance
back to the market when P R

t, is positive.

The last term in (16) is used to guarantee that the retailer
fullls most of the demand on day-ahead market by imposing a
penalty P
t for per unit imbalance. This complies with the policy
of system operators that the day-ahead market should reect the
t, and P R
physical conditions. Two non-negative variables P R+
t,
are used to calculate the absolute value of the imbalance while
ensuring the problem linear. They could be determined by P R
t,
according to (19).

t, = P R+
P R

t,  P R

t, ,t, 

(19)

A risk measure is included to consider the volatility of the
prot for different bidding strategies. For a given conden-
tial level , the CVaR is dened as the expected prot of the
(1  )  100 scenarios with the lowest prots. Using the ex-
pression in (16) for the prot of each scenario, the CVaR for a
condential level  is computed as:

 

(20)

(cid:3)

 =1

CVaR = Max   1
1  
s.t.   T(cid:3)

t, Pt,  A
(S

t, P R
t,

t, P A

t, + R
t, ))t   ,

t, + P R

t=1
 P
t (P R+
  0,

(21)

(22)

The optimal value of  represents the highest prot such that
the probability of experiencing a prot not higher than  is
less than or equal to 1  . The auxiliary variable  equals
to the excess of  over the prot in scenario  if the excess is
positive [27].

For a planning horizon T , the optimization problem of a re-
tailer is formulated as (23). The overall objective function com-
bines the prot function (16) and the CVaR risk measure (20).
The latter is weighted using a risk factor   [0,), indicating
the trade-off between prot and risk.

(cid:3)

T(cid:3)

Max



 =1

t=1

t, Pt,  A
(S

t, P A

 P

t (P R+

t, + P R

t, ))t + (  1
1  

t, + R
t, P R
t,
(cid:3)

  )

 =1

(23)

Fig. 4. Bidding curve with four nodes, the calculations of purchased volume
on day-ahead market and imbalance.

loads of non-responding households:

J i , h, (cid:3)

(cid:3)
hh P
(cid:3)
i h , 



(cid:3)
i h, 
J i , h , (cid:3)

j=1

Pz , = P N
z , +
(cid:3)
hh N

+



Pi,j,h, ui,h,zj+1,

j=1

(15)

Pi,j,h, uR

i,h,zj+1, ,z, 

IV. SHORT-TERM PLANNING MODEL FOR RETAILERS

The prot of a retailer is the difference between the income
from selling electricity to customers and the cost of buying elec-
tricity from the wholesale market. Since a number of scenarios
are involved as demonstrated in Fig. 2, the expected prot in the
planning horizon is calculated as:
t, Pt,  A
(S

t,  P

t, + R

(cid:3)

T(cid:3)

t, P R

t, P A



t

 =1

t=1
(P R+

t, + P R

t, ))t

(16)

where  refers to the probability of scenario . The planning
horizon consists of T trading periods indexed by t.

The second term calculates the cost of buying electricity
from day-ahead market. A bidding curve as illustrated in Fig. 4
will be decided for each trading period and submitted on day-
ahead market. Based on the method proposed in [12], it is a
piecewise descending curve consisting of C nodes (Pt,1, t,1),
(Pt,2, t,2), ..., (Pt,C , t,C ), where t,1  t,2  ...  t,C and
Pt,1  Pt,2  ...  Pt,C . The curve is independent on scenar-
ios. For scenario , the spot price A
t, lies between t,c and
t,c+1, where c  {1, ..., C}. The purchase on day-ahead market
P A
t, is a linear interpolation between Pt,c+1 and Pt,c according
to (17).

t, = Pt,c+1 + (Pt,c  Pt,c+1)
P A

t,c+1  A
t,c+1  t,c

t,

,t,  (17)

The price values of the nodes t,c are xed to simplify the
problem and to ensure the model linear, whereas the volume
value Pt,c needs to be solved through optimization.

The third term concerns the imbalance settlement. The actual
t, .

power demand Pt, would probably not coincide with P A

s.t. constraints (17)------(19), (21), (22)
Pt,c  Pt,c+1,t, c
Pt,c , P R+

t,  0,t, c, 

t, , P R

SONG AND AMELIN: PURCHASE BIDDING STRATEGY FOR A RETAILER WITH FLEXIBLE DEMANDS IN DAY-AHEAD ELECTRICITY MARKET

1845

ui,h,z , = arg min{
Z(cid:3)

Eh, =

(cid:3)
i h , 
, h  hP

z =1



J i , h , (cid:3)

j=1

z , Pi,j,h, ui,h,zj+1, z
S

Z(cid:3)

z =1

s.t.

uix,h,z , +

ui,h,z , = 1,i, , h  hP



(cid:3)
h , \ix
y x

a(cid:3)

k=z

uy ,h,k ,  1,z, , h  hP

 , ix

(27)

(28)



(30)

(29)

a = z + Jix,h,  1, x = W, D, S, V
ui,h,z ,  SPi,h,z , ,i, z, , h  hP
ui,h,z ,  {0, 1},i, z, , h  hP
 }
The second step connects the load model and the planning
model by transferring the outputs from the former Pz , into the
inputs of the latter Pt, . The time slot of the load model z is
usually shorter than the length of trading period t to manage
the scheduling of different end uses. Thus, Pt, is the sum of
Pz , in several time slots (32). Besides, the relationship between
S
t, and S

z , is expressed as (33)

(31)

Pt, =

z
t

Pz , ,t, 

c(cid:3)

z =b

b = (t  1)

t
z

+ 1, c = t
z , ,t, , b  z  c

t
z

(32)

(33)

t, = S
S

In the third step, the retailer maximizes its short-term prot
through a certain bidding strategy which is scenario indepen-
dent. The equations involved are summarized as following:

(cid:3)

T(cid:3)

Max



 =1

t=1

t, Pt,  A
(S

t, P A

t, + R

 P

t (P R+

t, + P R

t, ))t + (  1
1  

s.t. P A

t, = Pt,c+1 + (Pt,c  Pt,c+1)

t, P R
t,
(cid:3)

 =1

t,c+1  A
t,c+1  t,c

t,

(34)

  )

,t, 

Fig. 5. Decision process of a retailer to determine the bidding strategy.

V. DECISION FRAMEWORK OF RETAILERS

For a planning horizon T , a decision framework is constructed
for the retailer to determine bidding curves. It combines the
aforementioned load model and short-term planning model. The
owchart of the framework which consists of three steps is
illustrated in Fig. 5. The scenarios need to be generated at the
beginning according to the scenario tree (Fig. 2).

In the rst step, the retailer determines the aggregate power
demands Pz , for each spot price scenario using the load model.
It is assumed that each household belonging to the responding
group minimizes the electricity cost by rescheduling the con-
trollable end uses. The new schedules subject to the operation
constraints as explained in Section III B. Major equations in the
step are summarized as following:

Pi,j,h, uR

i,h,zj+1, ,z, 

z , =
P F

h=1
z , = P R ef
P N

H(cid:3)

j=1

J i, h, (cid:3)

(cid:3)
i h, 
z , ,z, 
z ,  P F
(cid:3)
(cid:3)
i h , 
hh P
J i , h , (cid:3)



J i , h , (cid:3)

j=1

Pz , = P N
z , +
(cid:3)
i h , 

(cid:3)
hh N

+



j=1

Pi,j,h, ui,h,zj+1,

Pi,j,h, uR

i,h,zj+1, ,z, 

(24)

(25)

(26)

Pt,c  Pt,c+1,t, c
t, = P A
P R
t, = P R+
P R

t,  Pt, ,t, 
t,  P R
t, ,t, 
t, Pt,  A
(S

  T(cid:3)
t=1
 P
t (P R+
Pt,c , P R+

t, P A

t, + R
t, ))t   ,
t, ,   0,t, c, 

t, + P R
t, , P R

t,  P

t, P R

t (P R+

t,

(35)

(36)

(37)

(38)

(39)

(40)

1846

IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 32, NO. 3, MAY 2017

TABLE I

PARAMETERS IN THE PLANNING MODEL

TABLE II

PARAMETERS IN THE LOAD MODEL

Value or method

Parameters

Washer

Dishwasher

Dryer

EV

Parameters

[hour]

T

C
 t
 
S
t ,  [EUR/MWh]
A
t ,  [EUR/MWh]
R
t ,  [EUR/MWh]
P
t ,  [EUR/MWh]


24
60
13
1

t ,  )  prob.(R
150%A

t , 

prob.(A

t,  )

Estimated from SARIMA

Estimated from SARIMA and Markov

15
95%

Probability distribution

x = S
53.2%
39.5%
6.6%
0.7%

Fig. 5

8

0.08

2

0.08
0.08
0.08

2
0.3
0.15



x = D






+ 7

S T R

i W, h
6

2
2
2
1.6
1.3
0.94





x = V
90%
10%




 N (64, 8)

14

2.3
2.3
2.3
2.3
2.3
2.3
2.3
2.3
2.3

x = W
49.3%
39.3%
10.6%
0.8%

Fig. 5

7

0.1
2
0.9
0.1
0.1
0.3
0.05




S T R

S T R
i , h
i , h + 11
10000

15
96

Obtained from Fig. 6

h,  = 0
I x
h,  = 1
I x
h,  = 2
I x
h,  = 3
I x
S T R

i, h, 

J i, h,  [15min]

P i, 1 , h,  [kW]
P i, 2 , h,  [kW]
P i , 3 , h,  [kW]
P i , 4 , h,  [kW]
P i , 5 , h,  [kW]
P i , 6 , h ,  [kW]
P i , 7 , h,  [kW]
P i , 8 , h,  [kW]
P i , 9 1 4 , h,  [kW]
S T 1
S T 2

i, h, 

i, h, 

H
 z [min]
Z [15 min]
d

Fig. 6.
dishwasher and washing machine.

Probability distributions of the reference start

time ST R

i, h,  for

h, and I S

The length of time slot z is 15 minutes when applying
the load model. Parameters regarding the stochastic reference
consumption behaviors are randomly set for each spot price
scenario. It is assumed that all households have a dishwasher,
a washing machine and a tumble dryer. The numbers of daily
washing and dish washing cycles, I W
h, , are respec-
tively determined by the arbitrary probability distributions as
shown in Table II. Their reference start time ST R
i,h, are sub-
ject to the probability distribution in Fig. 6. These distributions
are based on data from Statistics Sweden [34] and a previ-
ous numerical study [35]. 70% of washing cycles are supposed
immediately followed by a drying cycle [32]. Identical load pat-
terns are adopted for all cycles of the same appliances in all
households. The operation time and power demands of each
load cycle, Ji,h, and Pi,j,h, , are based on an EU survey [32]
as shown in Table II. The average power demands of a cycle are
0.89 kWh, 2.4 kWh and 1.19 kWh for washing machine, dryer
and dishwasher, respectively.

VI. CASE STUDY

A. Data

A simulation is performed using the proposed planning frame-
work to determine bidding strategies for a retailer on day-ahead
market. The retailer is assumed to provide electricity to 10000
households with exible power demands. The planning horizon
is 24 hours with trading periods as 1 hour.

As demonstrated in Fig. 2, spot price scenarios are generated
at rst. 500 24-hour spot price scenarios are generated using Sea-
sonal Autoregressive Integrated Moving Average (SARIMA)
model and then reduced to 20 scenarios with different probabil-
ities using k-means clustering function in Matlab. The param-
eters of SARIMA model are estimated based on the spot price
series from Nord Pool Spot in 2014. Assuming the customers
are charged a real-time price for electricity consumption, the
actual power demand due to demand response Pt, is estimated
for each spot price scenario with the proposed load model. For
simplication, the selling price S
t, is assumed as 150% of the
spot price A
t, to reect the volatility of spot price and keep a
revenue margin for the retailer.

Then, regulating price scenarios are generated using a com-
bination of SARIMA and Markov process developed by [33].
The difference between the regulating price and the spot price
in each hour is determined by SARIMA, while the regulation
direction is determined by Markov process. Three regulating
price scenarios are generated for each spot price scenario with
different regulation directions for the rst hour in the planning
horizon: up-regulation, down-regulation or non-regulation. The
parameters of SARIMA model and the transition probabilities
of Markov process are estimated based on the regulating price
series from Nord Pool Spot in 2014. Sixty scenarios are gener-
ated totally when applying the short-term planning model. 
equals to the product of the probabilities of the spot price and
the regulating price in scenario .

A one-price system is applied for imbalance settlement i.e.
a uniform regulating price is adopted for both positive and
negative imbalance in an hour. A constant imbalance penalty
t = 15 EUR/MWh is used for simplication. 13 nodes are
P
used to construct bidding curves within the price interval be-
tween 0 and 90 EUR/MWh. The condential level of CVaR
is set as 95%. Table I lists the major parameters in the
planning model.

SONG AND AMELIN: PURCHASE BIDDING STRATEGY FOR A RETAILER WITH FLEXIBLE DEMANDS IN DAY-AHEAD ELECTRICITY MARKET

1847

effectiveness of the method. Examples of scenario reduction
algorithms are described in [37] and [38].

B. Results

Fig. 8 shows the expected aggregate load for the planned
24 hours in both reference condition and after demand response.
When the real-time pricing is applied, the peak of aggregate
load is levelled down after demand response. Loads are mostly
shifted to the afternoon (Hour 15-16) and evening (Hour 21-24)
with relatively lower prices. The load change in each hour is
caused by changing the time of controllable home appliances
and EV charging. Only slight load increases are observed during
Hour 3-6 even though the prices in the period are almost the
lowest. It is due to the 3-hour-delay assumption and the reference
consumption pattern in which only a few exible loads exist
during night.

Fig. 9 demonstrates the inuence of risk factor  on retailers
prot and risk for the planned 24 hours with a condential level
of 95%. The risk-neutral bidding strategy ( = 0) attains the
highest expected prot and highest risk, which is measured as
CVaR. When the retailer becomes more risk-averse with larger
, it gets lower expected prot but also lower risk. The lower
risk reects in the increasing of CVaR which is the expected
prot of the 5% worst scenarios.

The purchase on day-ahead market and the corresponding
imbalance for each  are shown in Figs. 10 and 11, respectively.
When  becomes larger, the retailer tends to purchase less elec-
tricity on day-ahead market. This leads to a growing imbalance
quantity with more negative imbalance and less positive imbal-
ance (as dened in (18) and (19)). Making the bidding curves
deviate more from the power demands would result in a reduc-
tion of the expected prot due to the growing imbalance penalty.
But this could still be preferable for risk-averse retailers. In this
case, the expected regulating price is lower than the expected
spot price in all hours. Therefore, the retailer could buy elec-
tricity at a lower price on average during imbalance settlement
through expanding the negative imbalance. The CVaR increases
in this way, implying that the expected prot of the worst 5%
scenarios becomes higher when there is more negative imbal-
ance. But as shown in Fig. 8, the expected prot and CVaR do
not change any more when  is greater than 1.25. The retailer
can still enlarge the negative imbalance by further altering the
bidding strategy. But it may lead to a quick reduction of prot
in all scenarios due to the growing imbalance penalty.

Figs. 12 and 13 provide two examples of the bidding curves
and load scenarios in particular hours. Fig. 12 is for Hour 19.
When  increases until  = 0.75, the lower part of the bidding
curve gradually shifts towards left. For each scenario, shifting
the curve towards left implies a reduction of the purchase on day-
ahead market. This complies with the trend shown in Fig. 10.
The imbalance in each scenario is listed in Table III. It reects
the deviation between the curve and the load scenario. Positive
imbalance happens when a load scenario locates on the left side
of the curve, implying that the purchase on day-ahead market
is larger than the actual power demand. Contrarily, negative
imbalance occurs when a load scenario is on the right side of

Fig. 7. The relationship between demand response participation rate d and
peak/off-peak price ratio.

10% of the households are supposed to own an EV. The
parameters of EV charging are also listed in Table II. Each
vehicle is charged once a day. Slow charging at 10 A and 230 V
is used concerning the availability of charging infrastructures.
Accordingly the required charging time is 3.5 hours based on the
average driving distance and average energy consumption of EV
in Sweden [20]. A charging cycle iV takes place when the car
returns home and is connected to power until the battery is fully
charged. The reference connecting time ST R
iV ,h, is determined
by the sum of leaving time LiV ,h, and the away time AiV ,h, .
LiV ,h, stands for the time when the car leaves home. AiV ,h,
stands for the period during which the car stays away from home.
They are subject to normal distributions, LiV ,h,  N(28, 8)
and AiV ,h,  N(36, 8), according to a Swedish study about
the driving habits of Swedes [36].

The aggregate load in reference condition P R ef

z , is estimated
based on a measurement of a residential area in Stockholm
which is 4561.4 kWh/household year on average. P R ef
z , is ob-
tained by adding the reference EV charging load to the data.
The responsiveness to the dynamic tariff is assumed positively
correlated to the peak/off-peak price ratio. Such a relationship
is designed as Fig. 7, showing that a larger percentage of the
group would like to participate in demand response when the
peak/off-peak price ratio is higher. In this study, 10000d house-
holds are randomly selected to reschedule the exible loads in
each spot price scenario according to the peak/off-peak price
ratio. To simulate the most probable situation, each responding
household would delay appliances and EV charging by up to
3 hours to get a lower cost.

The optimizations are addressed in GAMs on an Intel i7-
2600K CPU @ 3.40GHz. Cplex is used to solve the linear and
integer linear programs. Load forecasting is the most time con-
suming step in the decision process. In the case 3650 households
need to be rescheduled on average in one spot price scenario.
The average CPU time of a scenario is 283 s for the 24-hour
planning horizon. The execution time of the whole process de-
pends on the number of scenarios. For an implementation with a
large number of scenarios, parallel computing can speed up the
process by distributing the optimizations in different scenarios
among multiple processors or cores. Furthermore, it is impor-
tant to construct a scenario tree which can capture the stochastic
properties with relatively few scenarios in order to improve the

1848

IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 32, NO. 3, MAY 2017

Fig. 8.

Spot price and the comparison of load patterns between reference condition and after demand response (expected values are used for price and load).

Fig. 9. Comparison of bidding strategies regarding the expected prot and the
low-prot risk.

Fig. 12. Bidding curves under different risk factors and load scenarios in
Hour 19.

Fig. 10.

Purchase on day-ahead market under different risk factors.

Fig. 11.

Imbalance under different risk factors.

Fig. 13. Bidding curve and load scenarios in Hour 16.

the curve, implying that the purchase on day-ahead market is
smaller than actual power demand. The imbalance is 0 if a load
scenario is just on the curve. As shown in Table III, the positive
imbalances decrease and the negative imbalances increase when
 becomes larger. This is in accordance with the indication of
Fig. 11. The curve does not change further when  is larger than
0.75. This also complies with the inference of Fig. 9 that the
retailer can only improve CVaR within limits.

Fig. 13 shows the load scenarios and bidding curve for Hour
16. Compared with Hour 19, the load curve for Hour 16 dis-
plays lower sensitivity to the change of . An identical curve
is obtained for all . The different sensitivity to  is due to
the different spread of load scenarios to some extent. As ob-
served on Figs. 12 and 13, a negative correlation 0.72 is found

SONG AND AMELIN: PURCHASE BIDDING STRATEGY FOR A RETAILER WITH FLEXIBLE DEMANDS IN DAY-AHEAD ELECTRICITY MARKET

1849

IMBALANCE IN DIFFERENT SCENARIOS [MWH]

TABLE III

Scenario

Hour 16

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
Expected imbalance

all 
0.55
0.00
1.39
0.20
0.04
0.96
0.55
0.24
0.59
0.30
0.42
0.45
0.50
0.72
0.55
0.02
0.12
0.08
0.00
0.00
0.33

 = 0

0.00
0.00
0.00
0.00
0.00
0.00
0.13
0.18
0.18
0.20
0.05
0.55
0.29
0.29
0.17
0.00
0.23
0.05
0.20
0.40
0.17

Hour 19

 = 0.25

 = 0.5

0.00
0.16
0.00
0.00
0.03
0.00
0.13
0.27
0.34
0.24
0.05
0.39
0.45
0.45
0.33
0.06
0.06
0.00
0.04
0.24
0.20

0.00
0.32
0.00
0.05
0.16
0.00
0.12
0.43
0.49
0.40
0.00
0.24
0.61
0.60
0.49
0.21
0.09
0.16
0.12
0.08
0.28

  0.75

0.00
0.40
0.00
0.13
0.24
0.00
0.07
0.51
0.57
0.48
0.08
0.16
0.69
0.68
0.57
0.29
0.17
0.24
0.20
0.00
0.34

between the price and the power demand among the load sce-
narios for Hour 19, whereas a positive correlation 0.72 is found
for Hour 16. The positive correlation makes it more difcult for
using a descending curve to maintain a limited imbalance in all
scenarios for Hour 16. So the expected imbalance of Hour 16 is
larger than that of Hour 19 in most cases.

The positive correlation implies that the load change in an
hour is not only inuenced by the price change in the single hour.
It is also affected by the relationship between the price in the
hour and the prices in other hours. So there is no guarantee that
a higher spot price in an hour must lead to a lower load. Taking
Hour 16 as an example, an amount of load is shifted towards it
when its price is lower than previous hours (similar as in Fig. 8
for the expected spot price). The load shift direction remains the
same when its price increases if it is still lower than the previous
hours. Moreover, a higher demand response participation rate d
may occur if the peak/off-peak ratio also increases. This leads to
more households responding to the dynamic tariffs by shifting
loads towards low-price period which is Hour 16 in the example.
It consequently results in the positive correlation between the
price and the power demand in the hour.

The retailer faces uncertainties of spot price when it needs to
determine the bids. Thus, a number of scenarios have been gen-
erated to provide possible realizations of the price. The retailer
can have two options in case the actual spot price is higher than
the highest price value on bidding curves. One way is to extend
the bidding curve. As shown in the two examples in Figs. 12
and 13, it is possible to extend the curves vertically for the
price above 90 EUR/MWh. Another way is to keep the bidding
curve unchanged so that nothing will be purchased on day-ahead
market. All consumptions will be settled as imbalance instead.
But generally, the retailer is assumed having a good knowledge
about the market. So the actual spot price is considered within
the range dened by the scenarios in this case.

VII. CONCLUSION

This paper develops a short-term planning framework for
retailers to determine bidding strategies on day-ahead market.
The tool consists of two parts: a load model for forecasting
the aggregate power demand of a consumer group in demand
response, and a planning model for constructing bidding curves
to maximize the benets of the retailer. The uncertainties of
spot price, regulating price and power demand are tackled using
stochastic programming. The study is based on a price-taker
assumption that the bids have no inuence on the market price.
The interactions between the exible demand of a price-maker
retailer and the market clearing price can be studied in the future.
The proposed load model looks into details of the exible
end uses in households including controllable home appliances
and EV charging. It captures the stochastic characteristics of
the exibility regarding the reference consumption pattern and
the responsiveness to dynamic tariffs. The case study shows that
the real-time price affects the aggregate load of a residential con-
sumer group in terms of the load shift towards low-price periods.
The model can be further applied to simulate consumers be-
havior under different dynamic price structures and forecast the
capacity and duration of the exibility. This is not only crucial
for retailers to make the procurement plans, but also important
for other players in the power market. For example, the model
could be utilized by aggregators to estimate the exibility of an
aggregation of individual demand side resources. It could also
help grid owners to learn about the responsiveness of customers
to different economic incentives in order to set proper network
tariffs for managing network congestions. The model involves a
series of random parameters regarding the consumption pattern
and willingness to respond. More sensitivity analysis could be
performed in the future.

The case study also shows that a risk-averse retailer tends to
adopt the bidding strategies with larger imbalances. The benet
lies in the reduction of low-prot risk. However, the aversion to
risk can only be kept in a certain level. A larger imbalance may
lead to a quick reduction of prot due to the growing imbalance
penalty. This allows retailers to comply with the policy of system
operator and try to satisfy the demand from day-ahead market.

REFERENCES

[1] R. H. Boroumand and G. Zachmann, Retailers risk management and
vertical arrangements in electricity markets, Energy Policy, vol. 40,
pp. 465472, 2012.

[2] E. A. Feinberg and D. Genethliou, Load forecasting, in Mathematics for
Restructured Electric Power Systems: Optimization Control, and Compu-
tational Intelligence. New York, NY, USA: Springer, 2005, pp. 269285.
[3] A. Faruqui and S. Sergici, Household response to dynamic pricing of
electricity: A survey of 15 experiments, J. Regul. Econ., vol. 38, no. 2,
pp. 193225, 2010.

[4] D. Hammerstrom, Pacic Northwest Gridwise Testbed Demonstration
Projects, Pacic Northwest Nat. Lab., Richland, WA, USA, Tech. Rep.
PNNL-17167, 2007.

[5] IBM, Ontario Energy board smart price pilotFinal report, Ontario

Energy Board, Toronto, ON, Canada, Tech. Rep., 2007.

[6] D. Violette, J. Erickson, and M. Klos, Final report for the mypower pric-
ing segments evaluation, Public Service Elect. Gas Company, Newark,
NJ, USA, Tech. Rep., 2007.

[7] C. Bartusch, F. Wallin, M. Odlare, I. Vassileva, and L. Wester, Introducing
a demand-based electricity distribution tariff in the residential sector:
Demand response and customer perception, Energy Policy, vol. 39, no. 9,
pp. 50085025, 2011.

1850

IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 32, NO. 3, MAY 2017

[8] SEDC, Mapping demand response in Europe today, Smart Energy De-
mand Coalition, Brussels, Belgium, Tech. Rep. SEDC-Mapping-DR-In-
Europe-2014 0411, Apr. 2014.

[9] D. S. Kirschen and S. Member, Demand-side view of electricity markets,

IEEE Trans. Power Syst., vol. 18, no. 2, pp. 520527, May 2003.

[10] C. Triki and A. Violi, Dynamic pricing of electricity in retail markets,

4ORQuart. J. Oper. Res., vol. 7, no. 1, pp. 2136, Oct. 2007.

[11] A. Hatami, H. Sei, and M. K. Sheikh-El-Eslami, A stochastic-based
decision-making framework for an electricity retailer: Time-of-use pricing
and electricity portfolio optimization, IEEE Trans. Power Syst., vol. 26,
no. 4, pp. 18081816, Nov. 2011.

[12] S. E. Fleten and E. Pettersen, Constructing bidding curves for a price-
taking retailer in the Norwegian electricity market, IEEE Trans. Power
Syst., vol. 20, no. 2, pp. 701708, May 2005.

[13] A. Badri and H. Kashe, Optimal bidding strategy of retailers in a mixed
pool-bilateral market considering demand response programs, in Proc.
IEEE Smart Grid Conf., 2013, pp. 131137.

[14] H. A. Aalami, M. P. Moghaddam, and G. R. Youse, Modeling and
prioritizing demand response programs in power markets, Elect. Power
Syst. Res., vol. 80, pp. 426435, 2010.

[15] N. Mahmoudi, M. Eghbal, and T. K. Saha, Employing demand response
in energy procurement plans of electricity retailers, Int. J. Elect. Power
Energy Syst., vol. 63, pp. 455460, 2014.

[16] C. Gorria, J. Jimeno, I. Laresgoiti, M. Lezaun, and N. Ruiz, Forecasting
exibility in electricity demand with price/consumption volume signals,
Elect. Power Syst. Res., vol. 95, pp. 200205, 2013.

[17] M. Skillback and H. Ibrahim, Evaluation methods for market models
used in smart grids: An application for the Stockholm royal seaport, M.S.
thesis, Dept. Elect. Power Syst., KTH, Stockholm, Sweden, 2012.

[18] J. G. Kassakian et al., The impact of distributed generation and electric
vehicles, in The Future of the Electric Grid: An Interdisciplinary MIT
Study, MIT, Cambridge, MA, USA, 2011, ch. 5, pp. 109126.

[19] S. Gottwalt, W. Ketter, C. Block, J. Collins, and C. Weinhardt, Demand
side management: A simulation of household behavior under variable
prices, Energy Policy, vol. 39, no. 12, pp. 81638174, 2011.

[20] P. Grahn, J. Rosenlind, P. Hilber, K. Alvehag, and L. Soder, A method for
evaluating the impact of electric vehicle charging on transformer hotspot
temperature, in Proc. IEEE PES Int. Conf. Exhib. Innov. Smart Grid
Technol., 2011, pp. 18.

[21] N. Jewell, L. Bai, J. Naber, and M. L. McIntyre, Analysis of electric
vehicle charge scheduling and effects on electricity demand costs, Energy
Syst., vol. 5, pp. 767786, 2014.

[22] J. Lujano-Rojas, C. Monteiro, R. Dufo-Lopez, and J. Bernal-Agustin,
Optimum residential load management strategy for real time pricing
demand response programs, Energy Policy, vol. 45, pp. 671679, 2012.
[23] C. Roe, S. Meliopoulos, R. Entriken, and S. Chhaya, Simulated demand
response of a residential energy management system, in Proc. IEEE Conf.
Energytech, 2011, pp. 16.

[24] H. Wu, M. Shahidehpour, A. Alabdulwahab, and A. Abusorrah, A game
theoretic approach to risk-based optimal bidding strategies for electric
vehicle aggregators in electricity markets with variable wind energy
resources, IEEE Trans. Sustain. Energy, vol. 7, no. 1, pp. 374385,
Jan. 2016.

[25] M. G. Vaya and G. Andersson, Optimal bidding strategy of a plug-in elec-
tric vehicle aggregator in day-ahead electricity market under uncertainty,
IEEE Trans. Power Syst., vol. 30, no. 5, pp. 23752385, Sep. 2015.

[26] S. I. Vagropoulos and A. G. Bakirtzis, Optimal bidding strategy for
electric vehicle aggregators in electricity markets, IEEE Trans. Power
Syst., vol. 28, no. 4, pp. 40314041, Nov. 2013.

[27] A. J. Conejo, M. Carrion, and J. M. Morales, Risk management, in
Decision Making Under Uncertainty in Electricity Markets. New York,
NY, USA, Springer, 2010, ch. 4, pp. 121152.

[28] C. Bang, F. Fock, and M. Togeby, The existing Nordic regulating power
market, Energy Analysis, Copenhagen, Denmark, Tech. Rep. FlexPower
WP1-Report 1, 2012.

[29] B. Biegel, L. H. Hansen, J. Stoustrup, P. Andersen, and S. Harbo, Value
of exible consumption in the electricity markets, Energy, vol. 66,
pp. 354362, 2014.

[30] K. C. Sou, J. Weimer, H. Sandberg, and K. H. Johansson, Scheduling
smart home appliances using mixed integer linear programming, in Proc.
IEEE Conf. Decision Control Eur. Control Conf., 2011, pp. 51445149.

[31] K. C. Sou, K. Mikael, J. Wu, H. Sandberg, and K. H. Johansson, Energy
and CO2 efcient scheduling of smart home appliances, in Proc. IEEE
Eur. Control Conf., 2013, pp. 40514058.

[32] R. Stamminger, Synergy potential of smart appliances, Univ. Bonn,

Bonn, Germany, Tech. Rep. EIE/06/185/SI2.447477, 2008.

[33] M. Olsson and L. Soder, Modeling real-time balancing power market
prices using combined Sarima and Markov processes, IEEE Trans. Power
Syst., vol. 23, no. 2, pp. 443450, May 2008.

[34] J. Zimmermann, End-use metering campaign in 400 households in Swe-
den assessment of the potential electricity savings, Flines-Rimandoule,
Enertech, Tech. Rep. 17-05-2743, vol. 17, 2009.

[35] M. Song, K. Alvehag, J. Widen, and A. Parisio, Estimating the impacts
of demand response by simulating household behaviours under price and
CO2 signals, Elect. Power Syst. Res., vol. 111, pp. 103114, 2014.

[36] L. Abramowski and A. Holmstrom, Res 20052006 den nationella resva-
neundersokningen, Statens Institut Kommunikationsanalys, Stockholm,
Sweden, Tech. Rep. TK1101BR0601, 2007.

[37] J. Dupacoa, N. Growe-Kuska, and W. Romisch, Scenario reduction in
stochastic programming: An approach using probability metrics, Math.
Program. Ser. A, vol. 95, pp. 493511, 2003.

[38] H. Heitsch and W. Romisch, Scenario reduction algorithms in stochastic

programming, Comput. Optim. Appl., vol. 24, pp. 187206, 2003.

Meng Song (S14) was born in China in 1982.
She received the B.Eng. degree from Tsinghua Uni-
versity, Beijing, China, in 2004 and the M.Sc. de-
gree from Royal Institute of Technology (KTH),
Stockholm, Sweden, in 2013. She has been working
toward the Ph.D. degree at the School of Electrical
Engineering in KTH since 2014. Her Ph.D. research
topic concerns the controlling, planning, and opera-
tion of the demand side exibility in smart grids.

Mikael Amelin (M07)
received the Masters,
Licentiate, and Ph.D. degrees from the Royal Insti-
tute of Technology (KTH), Stockholm, Sweden, in
1997, 2000, and 2004, respectively. He is an Asso-
ciate Professor in the School of Electrical Engineer-
ing, KTH. His research interests include Monte Carlo
techniques, analysis and modeling of electricity mar-
kets, and rural electrication in developing countries.

